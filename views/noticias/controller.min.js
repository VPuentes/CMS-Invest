angular.module("inspinia").controller("Noticias",["$rootScope","$scope","$state","$http","$stateParams","SweetAlert","DTOptionsBuilder","DTColumnDefBuilder",function(e,o,t,r,i,a,n,s){o.dtOptions=n.newOptions().withOption("bFilter",!1).withOption("order",[0,"desc"]).withLanguage({sProcessing:"Procesando...",sLengthMenu:"Mostrar _MENU_ registros",sZeroRecords:"No se encontraron resultados",sEmptyTable:"Ningún dato disponible en esta tabla",sInfo:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",sInfoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",sInfoFiltered:"(filtrado de un total de _MAX_ registros)",sInfoPostFix:"",sSearch:"Buscar:",sUrl:"",sInfoThousands:",",sLoadingRecords:"Cargando...",oPaginate:{sFirst:"Primero",sLast:"Último",sNext:"Siguiente",sPrevious:"Anterior"},oAria:{sSortAscending:": Activar para ordenar la columna de manera ascendente",sSortDescending:": Activar para ordenar la columna de manera descendente"}}),o.DTColumnDefs=[s.newColumnDef(3).notSortable()],o.loading=!0,r.get("php/noticias.php").success(function(e){o.noticias=e,o.loading=!1}),o.activar=function(e){r.get("php/noticias_activar.php?idnoticia="+e).success(function(e){t.go(t.current,{},{reload:!0})})},o.desactivar=function(e){r.get("php/noticias_desactivar.php?idnoticia="+e).success(function(e){t.go(t.current,{},{reload:!0})})}}]).controller("NoticiaNueva",["$rootScope","$scope","$http","$stateParams","SweetAlert","$state","Upload",function(e,o,t,r,i,a,n){var s=new Date;o.agregando=!1,r.idnoticia?(o.loading=!0,t.get("php/noticia.php?idnoticia="+r.idnoticia).success(function(t){o.forma=t,o.forma.idusuario=e.datos.idusuario,console.log(t)})):o.forma={idnoticia:0,idusuario:e.datos.idusuario,titulo:"",contenido:"",fecha_noticia:s,activo:!1,imagenes:[],rutas:[]},o.ver=function(){console.log(o.forma)},o.agregar=function(){o.agregando=!0,o.forma.fecha_noticia=moment(o.forma.fecha_noticia).toDate(),n.upload({url:"php/noticias_agregar.php",data:o.forma,method:"POST"}).then(function(e){console.log(e.data),o.agregando=!1,e.data.status&&a.go("noticias.index")},function(e){console.log("Error status: "+e.status),o.agregando=!1})},o.eliminarImg=function(e){t.get("php/noticias_imagenes_eliminar.php?idnoticia_imagen="+e).success(function(e){e.status&&a.go(a.current,{},{reload:!0})})}}]);