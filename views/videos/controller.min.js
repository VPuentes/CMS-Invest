angular.module("inspinia").controller("Videos",["$rootScope","$scope","$state","$http","$uibModal","$stateParams","SweetAlert",function(e,o,r,t,i,n,a){o.loading=!0,t.get("php/videos.php").success(function(e){o.videos=e,o.loading=!1}),o.obtener=function(e){o.video_principal=e},o.publicar=function(e,i,n){if(1==i)var s="¿Esta seguro que desea publicar el video?";else{if("1"==n)return void a.swal("No se puede remover el video principal","Debe seleccionar otro video como principal para poder removerlo");var s="¿Esta seguro que desea remover la publicacion del video?"}a.swal({title:s,text:"",type:"warning",showCancelButton:!0,confirmButtonColor:"#559bdd",confirmButtonText:"Si",cancelButtonText:"NO",closeOnConfirm:!0,closeOnCancel:!0},function(n){n&&t({method:"POST",url:"php/videos_publicar.php?idvideo="+e+"&numero="+i,data:JSON.stringify(o.valores)}).success(function(e,o,t,i){r.go(r.current,{},{reload:!0})}).error(function(e,o,r,t){console.log("error")})})},o.principal=function(){return void 0==o.video_principal?void a.swal({title:"Debe seleccionar un video",confirmButtonColor:"#559bdd"}):void a.swal({title:"¿Esta seguro que desea este video como el principal?",text:"",type:"warning",showCancelButton:!0,confirmButtonColor:"#559bdd",confirmButtonText:"Si",cancelButtonText:"NO",closeOnConfirm:!0,closeOnCancel:!0},function(e){e&&t({method:"POST",url:"php/videos_principal.php?idvideo="+o.video_principal,data:JSON.stringify(o.valores)}).success(function(e,o,t,i){r.go(r.current,{},{reload:!0})}).error(function(e,o,r,t){console.log("error ")})})}}]).controller("VideoNuevo",["$rootScope","$scope","$http","$stateParams","$uibModal","$state","toaster",function(e,o,r,t,i,n,a){function s(e){a.pop({type:"error",title:"ERROR",body:e,showCloseButton:!1,timeout:2400})}o.agregando=!1,t.idvideo?(o.loading=!0,r.get("php/video.php?idvideo="+t.idvideo).success(function(e){o.forma=e,o.loading=!1})):o.forma={idvideo:0,idusuario:e.datos.idusuario,titulo:"",url:""},o.agregar=function(){o.agregando=!0;var e=o.forma.url.search("facebook.com/");if(-1==e)return s("Debe ingresar la  url de un video de Facebook"),void(o.agregando=!1);var t=o.forma.url.indexOf("&");-1!=t?o.forma.c=o.forma.url.substr(0,t):o.forma.c=o.forma.url,r({method:"POST",url:"php/videos_agregar.php",transformRequest:angular.identity,headers:{"Content-Type":void 0},data:JSON.stringify(o.forma)}).success(function(e,r,t,i){o.agregando=!1,e.error?s(e.error):n.go("videos.index")}).error(function(e,r,t,i){o.agregando=!1,console.log(r)})}}]);